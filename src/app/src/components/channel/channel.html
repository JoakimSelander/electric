<ion-grid padding-top>
    <ion-row>
        <ion-col class="channelNumber">
            {{index + 1}}
        </ion-col>
        <ion-col>
            <ion-row>
                <ion-col class="cellcontainer" text-center>{{channel.curr_out_volts|number:'1.3-3'}}</ion-col>
                <ion-col class="cellcontainer" text-center>{{channel.curr_out_amps|number:'1.2-2'}}</ion-col>
                <ion-col class="cellcontainer" text-center>{{channel.curr_out_capacity|number:'1.0-0'}}</ion-col>
            </ion-row>

            <ion-row>
                <ion-col no-padding class="label" text-center>V</ion-col>
                <ion-col no-padding class="label" text-center>A</ion-col>
                <ion-col no-padding class="label" text-center>mAh</ion-col>
            </ion-row>
        </ion-col>
    </ion-row>

    <div class="cells" [ngSwitch]="channelMode">
        <div *ngSwitchCase="0" padding>
            <ion-spinner></ion-spinner>
        </div>
        <div *ngSwitchCase="1" id="master">
            <ion-row *ngFor="let r of chunkedCells(); let y=index">
                <ion-col (click)="toggleChannelMode()"
                         [ngClass]="{'unused' : isCellUnused(cell), 'empty' : isCellPadding(cell)}"
                         class="cell"
                         no-padding
                         *ngFor="let cell of r; let x=index"
                         text-center>
                    <ion-row *ngIf="!isCellPadding(cell)">
                        <ion-col width-20 class="channelnum">{{1 + ((y * cellChunking()) + x)}}</ion-col>
                        <ion-col text-center>{{cell.v|number:'1.3-3'}}v</ion-col>
                        <ion-col width-20 class="balancecontainer">
                            <div
                                    *ngFor="let b of balanceRange(cell.balance)"
                                    class="balance b{{b}}"
                                    [ngClass]="{'off':!balanceLightIsLit(b, cell.balance)}"
                            >
                            </div>
                        </ion-col>
                    </ion-row>
                </ion-col>
            </ion-row>
        </div>
        <div *ngSwitchCase="2" [style.min-height.px]="masterHeight">
            <ion-row>
                <ion-col>
                    <button ion-button (click)="startCharge()">Charge</button>
                </ion-col>
                <ion-col>
                    <button ion-button (click)="startDischarge()">Discharge</button>
                </ion-col>
                <ion-col>
                    <button ion-button (click)="startStore()">Store</button>
                </ion-col>
                <ion-col>
                    <button ion-button (click)="startBalance()">Balance</button>
                </ion-col>
                <ion-col>
                    <button ion-button (click)="meaureIR()">Measure IR</button>
                </ion-col>
                <ion-col>
                    <button ion-button (click)="switchToCellOutput()">Back</button>
                </ion-col>
            </ion-row>
        </div>
    </div>

    <ion-row padding-top class="cells summary">
        <ion-col no-padding>
            All cell volts: {{channel.cell_total_voltage|number:'1.3-3'}}V
            <!--mΩ-->
        </ion-col>
        <ion-col no-padding>
            ΔV: {{channel.maxMilliVoltDiff|number:'1.0-0'}} mV
        </ion-col>
    </ion-row>

</ion-grid>
